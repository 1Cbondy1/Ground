<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Project 1</title>
  <!-- Styling -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../css/reset.css">
  <!-- Materialize CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Custom Styling -->
  <link rel="stylesheet" type="text/css" href="../css/style.css">
  <!-- jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <!-- Firebase Reference -->
  <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
  <!-- firebase database -->
  <script src="https://www.gstatic.com/firebasejs/5.5.7/firebase.js"></script>
  <script src="../js/databaseHandler.js"></script>
  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <style>
    #map {
      height: calc(100vh - 56px);
      width: 100%;
    }
  </style>
</head>
<body>
    <!-- Navbar -->
  <nav>
      <div class="container">
        <div class="nav-wrapper">
          <a href="#!" class="brand-logo">Pick-up</a>
          <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
          <ul class="right hide-on-med-and-down">
            <li><a href="index.html">Home</a></li>
            <li><a href="donate.html">Donate</a></li>
            <li><a href="pickup.html">Pick-up</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Sidenav menu -->
    <ul class="sidenav" id="mobile-demo">
      <div class="sidenav-header">
        <h3>Ground</h3>
      </div>
      <li><a href="index.html"><i class="material-icons">home</i>Home</a></li>
      <li><a href="donate.html"><i class="material-icons">place</i>Donate</a></li>
      <li><a href="pickup.html"><i class="material-icons">directions_car</i>Pick-up</a></li>
      <li><div class="divider"></div></li>
      <!-- <li><a href="collapsible.html">Settings</a></li> -->
    </ul>

      <ul class="sidenav" id="mobile-demo-right">
        <img id="img-style" src="https://www.utexas.edu/sites/default/files/styles/utexas_hero_photo_image/public/tower_hero_v2.jpg" alt="notwork">
        <div class="row">
          <div class="col s12 m12">
            <div class="card darken-1">
              <div class="card-content text-info-light">
                <span class="card-title" id="cardTitle">Kickbutt Coffee</span>
                <p style="color:grey" id="cardPhone"></p>
                <p id="cardAddress">Address: 5755 Airport Blvd, Austin, TX 78752</p>
                <p>Details: 4 barrels of grounds that need to be picked up before Saturday!</p>
              </div>
              <div class="card-action">
                <form action="status.html">
                  <input style="display:none;" type="text" name="id" id="refID">
                  <br><br>
                  <input style="width:100%;" class="btn-large" type="submit" value="Claim!">
                </form>
              </div>
            </div>
          </div>
        </div>
      </ul>

      <!-- Maps -->
  <div id="map"></div>
  </body>
  <script>
    $(document).ready(function(){
      $('.sidenav').sidenav();
    });

    function initMap() {
      var options = {
        zoom: 10,
        center: {
          lat:30.2672,
          lng:-97.7431
        },
      }
      // Creates map on div element map
      var map = new google.maps.Map(document.getElementById('map'), options);
      // Creates marker on map for each firebase ref
      allRefs.forEach(function(ref) {
        var marker = new google.maps.Marker({
          position: {
            lat: ref.lat,
            lng: ref.long
          },
          map: map,
          id: ref.id,
        })
        // If cursor is clicked
        google.maps.event.addListener(marker, 'click', function(e){
          var bullshit = $("img");
          if (window.innerWidth >= 736) {
            bullshit = $(e.ya.currentTarget.parentElement.parentElement);
          }
          bullshit.sidenav();
          bullshit.addClass("sidenav-trigger");
          bullshit.attr("data-target", "mobile-demo-right");
          // Update sidenav with new business info
          $("#img-style").attr("src", ref.imageUrl)
          $("#cardTitle").text(ref.name);
          $("#cardPhone").text("Phone:" + ref.phone);
          $("#cardAddress").text(ref.address);
          console.log(ref.id);
          $("#refID").attr("value", ref.id);

        });
      })
    }
  </script>
  <!-- Maps -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC17zwRGsPRC86WH9sPD0ssYepeuEqC7nU"
  async defer></script>
</html>
